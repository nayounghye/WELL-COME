<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>section1</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/locomotive-scroll@3.5.4/dist/locomotive-scroll.css"
    />
    <link href="../cdn.js" />
    <style>
      body {
        margin: 0;
        padding: 0;
        height: 130vh;
      }

      /* 섹션 1 */
      .section1 {
        width: 100%;
        height: 100%;
        position: fixed;
        transition: opacity 0.5s ease;
      }

      .img-container {
        display: flex;
        width: 100%;
        height: 100vh;
        position: relative;
        overflow: hidden;
      }

      /* 이미지 공통 스타일 */
      img.img {
        width: 34vw; /* 뷰포트 너비의 30% */
        max-width: 660px;
        height: auto;
        position: absolute;
        box-shadow: 5px 5px 14px #0000007c;
      }

      @media screen and (max-width: 375px) {
        img.img {
          width: 300px;
          height: auto;
          box-shadow: 2px 2px 7px #0000007c;
        }
      }

      /* @media screen and (min-width: 1200px) {
      }

      @media screen and (min-width: 768px) and (max-width: 1200px) {
      }
      @media screen and (min-width: 360px) and (max-width: 768px) {
      }
 */

      /* 웰컴을 선택하는 이유? 텍스트 */

      .text-container {
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .section1Text.wellcome {
        font-size: 110px;
        font-weight: bold;
      }
      .section1Text.text {
        font-size: 100px;
      }

      .section1Text.choice {
        font-size: 140px;
        font-weight: bold;
      }

      /* 여권 이미지별 스타일 */
      img.passport1 {
        transform: translate(-80%, -45%) rotate(-8.515deg);
        left: 25%;
        top: 25%;
        z-index: 3;
      }
      img.passport2 {
        transform: translate(-55%, -30%) rotate(28.515deg);
        left: 50%;
        top: 10%;
        z-index: 2;
      }

      img.passport3 {
        transform: translate(-10%, -9%) rotate(-8.104deg);
        left: 75%;
        top: 10%;
        z-index: 1;
      }

      img.passport4 {
        transform: translate(-100%, -20%) rotate(17.104deg);
        left: 40%;
        top: 60%;
        z-index: 5;
      }

      img.passport5 {
        transform: translate(120%, -1%) rotate(-30.104deg);
        left: 10%;
        top: 40%;
        z-index: 4;
      }

      @media screen and (max-width: 768px) {
        img.img {
          width: 50vw;
        }
      }

      /* 여권 애니메이션 */
      @keyframes moveTo10 {
        to {
          transform: translate(-100vw, -100vh);
          opacity: 0;
        }
      }

      @keyframes moveTo12 {
        to {
          transform: translateY(-100vh);
          opacity: 0;
        }
      }

      @keyframes moveTo3 {
        to {
          transform: translateX(100vw);
          opacity: 0;
        }
      }

      @keyframes moveTo8 {
        to {
          transform: translate(-100vw, 100vh);
          opacity: 0;
        }
      }

      @keyframes moveTo5 {
        to {
          transform: translate(100vw, 100vh);
          opacity: 0;
        }
      }

      /* 섹션 2 */
      .section2 {
        opacity: 0;
        width: 100%;
        height: 100%;
        position: fixed;
        transition: opacity 0.5s ease;
      }

      .why-list {
        list-style-type: none;
        margin: 0;
        padding: 0;
      }

      .why-item {
        list-style: none;
        margin: 0;
        padding: 0;
        display: flex;
        flex-direction: column;
        justify-content: space-evenly;
        align-items: center;
        height: 20vh;
        width: 100%;
        font-size: 34px;
        font-weight: bolder;
        color: #fff;
      }

      .why-item1 {
        background-color: #9dd0ff;
      }

      .why-item2 {
        background-color: #7dc1ff;
      }
      .why-item3 {
        background-color: #5bb0ff;
      }
      .why-item4 {
        background-color: #309cff;
      }
      .why-item5 {
        background-color: #0f8cff;
      }
    </style>
  </head>
  <body>
    <!-- locomotive scroll cdn -->
    <script src="https://cdn.jsdelivr.net/npm/locomotive-scroll@3.5.4/dist/locomotive-scroll.css"></script>
    <!-- gsap cdn -->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"
      integrity="sha512-7eHRwcbYkK4d9g/6tD/mhkf++eoTHwpNM9woBxtPUBWm67zeAfFC+HrdoE2GanKeocly/VxeLvIqwvCdk7qScg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"
      integrity="sha512-onMTRKJBKz8M1TnqqDuGBlowlH0ohFzMXYRNebz+yOcc5TQr/zAKsthzhuv0hiyUKEiQEQXEynnXCvNTOk50dg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <div id="main">
      <section class="section1">
        <div class="img-container">
          <img
            src="../static/img/Korea.jpg"
            alt="passport3"
            class="img passport1"
            id="passport-img-1"
          />
          <img
            src="../static/img/China.jpg"
            alt="passport1"
            class="img passport2"
            id="passport-img-2"
          />
          <img
            src="../static/img/Japan.jpg"
            alt="passport2"
            class="img passport3"
            id="passport-img-3"
          />
          <img
            src="../static/img/USA.jpg"
            alt="passport4"
            class="img passport4"
            id="passport-img-4"
          />
          <img
            src="../static/img/Vietnam.jpg"
            alt="passport5"
            class="img passport5"
            id="passport-img-5"
          />
        </div>
      </section>
      <!-- <section class="section2">
      <div class="text-container">
        <h1 class="section1Text wellcome">웰컴</h1>
        <h1 class="section1Text text">을</h1>
        <h1 class="section1Text choice">선택</h1>
        <h1 class="section1Text text">하는</h1>
        <br />
        <h1 class="section1Text text">이유?</h1>
      </div>
    </section> -->
      <section class="section2">
        <ul class="why-list">
          <li class="why-item why-item1">选择"웰컴"的五大理由</li>
          <li class="why-item why-item2">选择"웰컴"的五大理由</li>
          <li class="why-item why-item3">选择"웰컴"的五大理由</li>
          <li class="why-item why-item4">选择"웰컴"的五大理由</li>
          <li class="why-item why-item5">选择"웰컴"的五大理由</li>
        </ul>
      </section>
      <section class="section4"></section>
    </div>
    <div class="box"></div>
    <script>
      const passportImages = document.querySelectorAll('img');
      const section1 = document.querySelector('.section1');
      const section2 = document.querySelector('.section2');
      let scrollTriggered = false; // 애니메이션 실행 여부
      let isAnimating = false; // 애니메이션 중인지 여부
      let lastScrollY = 0;

      section2.style.display = 'none'; // 처음에 section2는 보이지 않음

      // 스크롤 이벤트
      window.addEventListener('scroll', function () {
        const currentScrollY = window.scrollY;

        if (!isAnimating) {
          // 애니메이션 중이면 스크롤 이벤트 차단
          // 스크롤 다운 시 애니메이션 실행 후 section2 전환
          if (currentScrollY > lastScrollY && !scrollTriggered) {
            isAnimating = true; // 애니메이션 시작
            passportImages.forEach((img, index) => {
              resetAnimation(img);
              moveImage(img, 'normal', index === passportImages.length - 1);
            });
            scrollTriggered = true;
          }

          // 스크롤 업 시 section1으로 복귀 후 애니메이션 reverse 실행
          if (currentScrollY <= lastScrollY && scrollTriggered) {
            isAnimating = true; // 애니메이션 시작
            transitionToSection1(() => {
              passportImages.forEach((img, index) => {
                resetAnimation(img);
                moveImage(img, 'reverse', index === 0);
              });
            });
            scrollTriggered = false;
          }
        }
        lastScrollY = currentScrollY; // 스크롤 위치 업데이트
      });

      // 이미지 이동 함수
      function moveImage(img, direction, triggerTransition) {
        const duration = '1.5s';
        const animationName =
          img.id === 'passport-img-1'
            ? 'moveTo10'
            : img.id === 'passport-img-2'
            ? 'moveTo12'
            : img.id === 'passport-img-3'
            ? 'moveTo3'
            : img.id === 'passport-img-4'
            ? 'moveTo8'
            : img.id === 'passport-img-5'
            ? 'moveTo5'
            : '';

        img.style.animation = `${animationName} ${duration} forwards`;
        img.style.animationDirection =
          direction === 'reverse' ? 'reverse' : 'normal';

        // 마지막 이미지의 애니메이션 끝난 후 section2로 전환
        if (triggerTransition && direction === 'normal') {
          img.addEventListener('animationend', transitionToSection2, {
            once: true,
          });
        }
      }

      // 애니메이션을 다시 적용할 수 있도록 초기화
      function resetAnimation(img) {
        img.style.animation = 'none';
        img.offsetHeight; // 강제로 리플로우 발생
        img.style.animation = '';
      }

      // Section 2로 전환 함수
      function transitionToSection2() {
        section1.style.opacity = '0';
        setTimeout(() => {
          section1.style.display = 'none';
          section2.style.display = 'block';
          setTimeout(() => {
            section2.style.opacity = '1';
            isAnimating = false; // 애니메이션 완료
          }, 15);
        }, 100);
      }

      // Section 1로 복귀 함수
      function transitionToSection1(afterTransitionCallback) {
        section2.style.opacity = '0';
        setTimeout(() => {
          section2.style.display = 'none';
          section1.style.display = 'block';
          setTimeout(() => {
            section1.style.opacity = '1';
            afterTransitionCallback();
            isAnimating = false; // 애니메이션 완료
          }, 15);
        }, 100);
      }
    </script>
  </body>
</html>
